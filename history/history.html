
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>2. Some history &#8212; Stellar Structure and Evolution</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. The equations of stellar structure and evolution" href="../equations/equations.html" />
    <link rel="prev" title="1. Instructions" href="../instructions/instructions.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Stellar Structure and Evolution</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../instructions/instructions.html">
   1. Instructions
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   2. Some history
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../equations/equations.html">
   3. The equations of stellar structure and evolution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../eos1/eos1.html">
   4. The energy equation and the equation of state
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../eos2/eos2.html">
   5. Degenerate equations of state
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../bibliography.html">
   6. Bibliography
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/orlox/stars_2022_2023/main?urlpath=tree/history/history.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/orlox/stars_2022_2023"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/orlox/stars_2022_2023/issues/new?title=Issue%20on%20page%20%2Fhistory/history.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/history/history.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pen-paper-exercises">
   2.1. Pen &amp; paper exercises
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#timescales-of-stellar-evolution">
     2.1.1. Timescales of stellar evolution
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solution-to-pen-paper-exercises">
   2.2. Solution to pen &amp; paper exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#julia-basics">
   2.3. Julia basics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sources">
     2.3.1. Sources
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Some history</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pen-paper-exercises">
   2.1. Pen &amp; paper exercises
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#timescales-of-stellar-evolution">
     2.1.1. Timescales of stellar evolution
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solution-to-pen-paper-exercises">
   2.2. Solution to pen &amp; paper exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#julia-basics">
   2.3. Julia basics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sources">
     2.3.1. Sources
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="some-history">
<h1><span class="section-number">2. </span>Some history<a class="headerlink" href="#some-history" title="Permalink to this headline">#</a></h1>
<section id="pen-paper-exercises">
<h2><span class="section-number">2.1. </span>Pen &amp; paper exercises<a class="headerlink" href="#pen-paper-exercises" title="Permalink to this headline">#</a></h2>
<section id="timescales-of-stellar-evolution">
<h3><span class="section-number">2.1.1. </span>Timescales of stellar evolution<a class="headerlink" href="#timescales-of-stellar-evolution" title="Permalink to this headline">#</a></h3>
<p>There are three main timescales in which stars evolve. These are the dynamical, thermal and nuclear timescales. Even without knowing the equations of stellar structure and evolution we can do some estimates on the value of these quantities. Compute these without a calculator! We only care about the order of magnitude of these timescales, which given all the approximations done is all we can do. For solar properties, use the following for the mass, radius and luminosity:</p>
<div class="math notranslate nohighlight">
\[R_\odot\sim 7\times 10^{10}\;\mathrm{[cm]},\quad M_\odot \sim 2\times 10^{33}\;\mathrm{[g]},\quad L_\odot \sim 4\times 10^{33}\;\mathrm{[erg\;s^{-1}]}\]</div>
<ul>
<li><p>Thermal timescale: One of the main early hypothesis to explain the energy source of the Sun was that it originated from its slow contraction into its own gravitational potential. In such a case, a rough estimate of the energy the Sun would have radiated through its life is given by the negative of the gravitational potential energy <span class="math notranslate nohighlight">\(E_\mathrm{g}\)</span>:</p>
<div class="math notranslate nohighlight">
\[E_\mathrm{g} \sim -\frac{GM_\odot^2}{R_\odot}.\]</div>
<p>Assuming that the luminosity of the Sun has always been its current one, <span class="math notranslate nohighlight">\(L_\odot\)</span>, compute the age of the Sun under the assumption that it is only powered by contraction.</p>
</li>
<li><p>Dynamical timescale: For most of their lives stars are very close to hydrostatic equilibrium, carefully balancing their gravities against the support of a pressure gradient. Whenever these two forces are misbalanced, the star will evolve in what is known as the dynamical timescale. Estimate this timescale by computing the time it would take for the surface of the sun to free-fall all the way to its center if all forces opposing gravity would be removed. For simplicity assume that the gravitational acceleration is constant and equal to its present one.</p></li>
<li><p>Nuclear timescale: As we now know, most stars are powered by nuclear reactions. Masses of isotopes are normally given in terms of the atomic mass unit <span class="math notranslate nohighlight">\(m_\mathrm{u}=1.661\times 10^{-24}\;\mathrm{g}\)</span>, defined as <span class="math notranslate nohighlight">\(1/12\)</span> of the mass of a carbon-12 atom. The mass of a hydrogen atom is <span class="math notranslate nohighlight">\(m_\mathrm{H}=1.007825m_\mathrm{u}\)</span> and that of a helium atom is <span class="math notranslate nohighlight">\(m_\mathrm{He}=4.002602 m_\mathrm{u}\)</span>, such that if four hydrogen atoms are fused into a helium atom there is a mass deficit leading to a release of energy <span class="math notranslate nohighlight">\((4m_\mathrm{H}-m_\mathrm{He})c^2\sim 4\times 10^{-5}\;\mathrm{[erg]}\)</span>. With this information, estimate the lifetime of the Sun as a core-hydrogen burning star. For simplicity, assume the Sun has a constant luminosity and is entirely composed of hydrogen, 10% of which is burned into Helium during core-hydrogen burning.</p></li>
</ul>
</section>
</section>
<section id="solution-to-pen-paper-exercises">
<h2><span class="section-number">2.2. </span>Solution to pen &amp; paper exercises<a class="headerlink" href="#solution-to-pen-paper-exercises" title="Permalink to this headline">#</a></h2>
</section>
<section id="julia-basics">
<h2><span class="section-number">2.3. </span>Julia basics<a class="headerlink" href="#julia-basics" title="Permalink to this headline">#</a></h2>
<p>For the first class we provide a computational example rather than exercises. All computational exercises will be shown using the <a class="reference external" href="https://julialang.org/"><em>julia</em></a> programming language, but the code provided can be easily translated to other languages such as python. The main benefit of julia is that it is a language that is simple to write but can still have a performance comparable to traditional compiled languages. A good overview of the language can be found in the official <a class="reference external" href="https://docs.julialang.org/en/v1/manual/getting-started/">manual</a>, but below we show some of the basic functionality that you will need to use.</p>
<p>First of all, we illustrate the basic usage of julia. A normal thing you will do at the beginning of any notebook or program is to include packages. Our life is made significantly easier by people who provide these packages! To do this, one makes use of the <code class="docutils literal notranslate"><span class="pre">using</span></code> keyword. Below we include the packages we will be using in this example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="n">DataFrames</span>     <span class="c"># Used to deal with tabular data</span>
<span class="k">using</span> <span class="n">Plots</span>          <span class="c"># Provides a multitude of plotting routines</span>
<span class="k">using</span> <span class="n">CSV</span>            <span class="c"># Efficient reading of files in &quot;comma separated values&quot; format</span>
<span class="k">using</span> <span class="n">LaTeXStrings</span>   <span class="c"># Makes it easy to write LaTeX strings</span>
</pre></div>
</div>
</div>
</div>
<p>Whenever you work on a fresh environment you will find the above code fails, as the packages are not installed. As described in the error message you can correct this by running (in a different cell) <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">Pkg;</span> <span class="pre">Pkg.add(&quot;DataFrames&quot;)</span></code>, and similarly for the other packages. Once this is done for a package, it will remain installed in your environment, and you don’t need to use <code class="docutils literal notranslate"><span class="pre">Pkg.add</span></code> again (it is safe to erase the cells with that command).</p>
<p>The syntax of julia should be familiar to those with a python background. Assigning numerical variables and performing arithmetic operations on them is straightforward.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">b</span> <span class="o">=</span> <span class="nb">pi</span> <span class="c"># the definition of pi is included by default</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span> <span class="c"># addition</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">b</span><span class="o">^</span><span class="n">a</span> <span class="c"># exponentiation</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="c"># basic mathematical functions are also defined in the language, no need to include a package</span>

<span class="n">print</span><span class="p">(</span><span class="s">&quot;c=</span><span class="si">$</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="s">, b=</span><span class="si">$</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="s">, c=</span><span class="si">$</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="s">&quot;</span><span class="p">)</span> <span class="c"># $() notation is used to read the value in parenthesis into the string</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c=5.141592653589793, b=9.869604401089358, c=0.0
</pre></div>
</div>
</div>
</div>
<p>One option that can let you increase the readability of code is the use of greek characters. To include these in a code block you can write <code class="docutils literal notranslate"><span class="pre">\beta</span></code> and then press tab, which will replace them with the corresponding greek character.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">β</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>  <span class="c"># Using &#39;;&#39; at the end of a line will hide its output</span>
</pre></div>
</div>
</div>
</div>
<p>You also have access to basic keywords for control flow, including <code class="docutils literal notranslate"><span class="pre">if</span></code> blocks and <code class="docutils literal notranslate"><span class="pre">for</span></code> loops. Here some small notational variations arise with respect to <code class="docutils literal notranslate"><span class="pre">python</span></code>. Blocks of code are not defined by indentation but by the use of the <code class="docutils literal notranslate"><span class="pre">end</span></code> keyword.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">3</span>

<span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">2</span>   <span class="c"># &amp;&amp; stands for &#39;and&#39;</span>
    <span class="n">print</span><span class="p">(</span><span class="s">&quot;if was successful&quot;</span><span class="p">)</span>
<span class="k">elseif</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">||</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">2</span>   <span class="c"># || stands for &#39;or&#39;</span>
    <span class="n">print</span><span class="p">(</span><span class="s">&quot;elseif was successful&quot;</span><span class="p">)</span>
<span class="k">else</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Neither if or elseif were successful&quot;</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span> <span class="c"># print a line break</span>

<span class="c"># Add up all digits between 1 and 10 using a for loop</span>
<span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="mi">10</span>
    <span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span><span class="o">+</span><span class="n">i</span>
<span class="k">end</span>
<span class="n">print</span><span class="p">(</span><span class="s">&quot;Adding all numbers between 1 and 10 gives us </span><span class="si">$</span><span class="p">(</span><span class="n">sum</span><span class="p">)</span><span class="s">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>elseif was successful
Adding all numbers between 1 and 10 gives us 55
</pre></div>
</div>
</div>
</div>
<p>We can also define functions using the <code class="docutils literal notranslate"><span class="pre">function</span></code> keyword.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">add1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span>
<span class="k">end</span>

<span class="n">add1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<p>We often deal not just with scalars but also vectors or matrices. We can define a vector covering a range of values using the <code class="docutils literal notranslate"><span class="pre">LinRange</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">xvals</span> <span class="o">=</span> <span class="kt">LinRange</span><span class="p">(</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span> <span class="c"># Create a vector with elements from -5.0 to 5.0 with 11 elements.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11-element LinRange{Float64, Int64}:
 -5.0,-4.0,-3.0,-2.0,-1.0,0.0,1.0,2.0,3.0,4.0,5.0
</pre></div>
</div>
</div>
</div>
<p>Beware that many operations on vectors will not work as you might naively expect. If you try computing <code class="docutils literal notranslate"><span class="pre">xvals^2</span></code>, an error will be thrown as the <code class="docutils literal notranslate"><span class="pre">^</span></code> operation is not defined between a vector and an integer. You could think that the above operation is ambiguous, do we mean that we want to take the square of each element of the vector or instead that we want to take the dot product of xvals with itself? To explicitly state that an operation is meant to be done element by element, one can use a <code class="docutils literal notranslate"><span class="pre">.</span></code> before the operation. Further information on this notation can be founde <a class="reference external" href="https://docs.julialang.org/en/v1/manual/functions/#man-vectorized">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">xvals</span><span class="o">.^</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11-element Vector{Float64}:
 25.0
 16.0
  9.0
  4.0
  1.0
  0.0
  1.0
  3.999999999999999
  9.0
 16.0
 25.0
</pre></div>
</div>
</div>
</div>
<p>This can be done with any function. For instance the code below will apply our <code class="docutils literal notranslate"><span class="pre">add1</span></code> function to each element of the array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">add1</span><span class="o">.</span><span class="p">(</span><span class="n">xvals</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11-element Vector{Float64}:
 -4.0
 -3.0
 -2.0
 -1.0
  0.0
  1.0
  2.0
  3.0
  4.0
  5.0
  6.0
</pre></div>
</div>
</div>
</div>
<p>Finally, the <code class="docutils literal notranslate"><span class="pre">Plots</span></code> package allows us to easily make different kinds of plots. The example below shows a (sparsely) sampled plot of sine and cosine. The plot can be created by calling the <code class="docutils literal notranslate"><span class="pre">plot(...)</span></code> function, while things are added to it by calling the <code class="docutils literal notranslate"><span class="pre">plot!()</span></code> function. Using <code class="docutils literal notranslate"><span class="pre">!</span></code> as part of a function name is part of the style guide of julia to identify functions which modify their arguments. For example, the <code class="docutils literal notranslate"><span class="pre">sort(x)</span></code> function will return a copy of the vector <code class="docutils literal notranslate"><span class="pre">x</span></code> which is sorted, while <code class="docutils literal notranslate"><span class="pre">sort!(x)</span></code> will modify the vector <code class="docutils literal notranslate"><span class="pre">x</span></code> into a sorted version of itself (known as in place sorting).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">yvals</span> <span class="o">=</span> <span class="n">sin</span><span class="o">.</span><span class="p">(</span><span class="n">xvals</span><span class="p">)</span>
<span class="n">yvals2</span> <span class="o">=</span> <span class="n">cos</span><span class="o">.</span><span class="p">(</span><span class="n">xvals</span><span class="p">)</span>
<span class="c"># The LaTeX strings package allows us to write LaTeX without needing to escape backslashes</span>
<span class="c"># (i.e., we can write L&quot;\sin(x)&quot; instead of &quot;$\\sin(x)$&quot;).</span>
<span class="n">plot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;</span><span class="si">$x</span><span class="s">$&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;</span><span class="si">$y</span><span class="s">$&quot;</span><span class="p">)</span> 
<span class="n">plot!</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">yvals</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;$\sin(x)$&quot;</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">yvals2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;$\cos(x)$&quot;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="ss">:dash</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/history_19_0.svg" src="../_images/history_19_0.svg" /></div>
</div>
<section id="sources">
<h3><span class="section-number">2.3.1. </span>Sources<a class="headerlink" href="#sources" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Gaia passband info: <a class="reference external" href="https://www.cosmos.esa.int/web/gaia/edr3-passbands">https://www.cosmos.esa.int/web/gaia/edr3-passbands</a></p></li>
<li><p>Gaia archive: <a class="reference external" href="https://gea.esac.esa.int/archive/">https://gea.esac.esa.int/archive/</a></p></li>
<li><p>Sun Gaia magnitude: <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2018MNRAS.479L.102C/abstract">https://ui.adsabs.harvard.edu/abs/2018MNRAS.479L.102C/abstract</a></p></li>
<li><p>Sun effective temperature (5772 K): Resolution B3 on recommended nominal conversion constants for selected solar and planetary properties Proposed by IAU Inter-Division A-G Working Group on Nominal Units for Stellar &amp; Planetary Astronomy The XXIXth International Astronomical Union General Assembly, <a class="reference external" href="https://www.iau.org/static/resolutions/IAU2015_English.pdf">https://www.iau.org/static/resolutions/IAU2015_English.pdf</a></p></li>
<li><p>Solar spectrum: <a class="reference external" href="https://www.nrel.gov/grid/solar-resource/spectra-astm-e490.html">https://www.nrel.gov/grid/solar-resource/spectra-astm-e490.html</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="mf">6.6261e-27</span>      <span class="c"># Planck&#39;s constant, cm^2 g s^-1</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">2.99792458e10</span>   <span class="c"># speed of light cm s^-1</span>
<span class="n">k_b</span> <span class="o">=</span> <span class="mf">1.3807e-16</span>    <span class="c"># Boltzmann constant erg K-1</span>
<span class="n">σ</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="nb">π</span><span class="o">^</span><span class="mi">5</span><span class="o">*</span><span class="n">k_b</span><span class="o">^</span><span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="mi">15</span><span class="o">*</span><span class="n">h</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">c</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="c"># Stefan-Boltzmann constant</span>
<span class="k">function</span> <span class="n">spectral_radiance</span><span class="p">(</span><span class="n">λ</span><span class="p">,</span><span class="n">T</span><span class="p">)</span> <span class="c">#λ in nm, T in Kelvin</span>
    <span class="n">λ_cm</span> <span class="o">=</span> <span class="n">λ</span><span class="o">*</span><span class="mf">1e-7</span>
    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">c</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">λ_cm</span><span class="o">^</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="n">λ_cm</span><span class="o">*</span><span class="n">k_b</span><span class="o">*</span><span class="n">T</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="k">end</span>
<span class="k">function</span> <span class="n">normalized_spectral_radiance</span><span class="p">(</span><span class="n">λ</span><span class="p">,</span><span class="n">T</span><span class="p">)</span> <span class="c">#λ in nm, T in Kelvin</span>
    <span class="n">peak_λ</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="mf">4.965</span><span class="o">*</span><span class="n">k_b</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="mf">1e7</span> <span class="c">#in nm</span>
    <span class="k">return</span> <span class="n">spectral_radiance</span><span class="p">(</span><span class="n">λ</span><span class="p">,</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="n">spectral_radiance</span><span class="p">(</span><span class="n">peak_λ</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>normalized_spectral_radiance (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">passbands</span> <span class="o">=</span> <span class="n">CSV</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&quot;passband.dat&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">delim</span><span class="o">=</span><span class="s">&quot; &quot;</span><span class="p">,</span> <span class="n">ignorerepeated</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;$\mathrm{Wavelength\;[nm]}$&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s">&quot;Transmissivity&quot;</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">passbands</span><span class="o">.</span><span class="n">lambda</span><span class="p">,</span> <span class="n">passbands</span><span class="o">.</span><span class="n">G_pb</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;G&quot;</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">passbands</span><span class="o">.</span><span class="n">lambda</span><span class="p">,</span> <span class="n">passbands</span><span class="o">.</span><span class="n">BP_pb</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;BP&quot;</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">passbands</span><span class="o">.</span><span class="n">lambda</span><span class="p">,</span> <span class="n">passbands</span><span class="o">.</span><span class="n">RP_pb</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;RP&quot;</span><span class="p">)</span>

<span class="n">xvals</span> <span class="o">=</span> <span class="kt">LinRange</span><span class="p">(</span><span class="mf">200.0</span><span class="p">,</span><span class="mf">1500.0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">normalized_spectral_radiance</span><span class="o">.</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span><span class="mi">5772</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;T=5772 K&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/history_22_0.svg" src="../_images/history_22_0.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">solar_spectrum</span> <span class="o">=</span> <span class="n">CSV</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&quot;solar_spectrum.dat&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">delim</span><span class="o">=</span><span class="s">&quot; &quot;</span><span class="p">,</span> <span class="n">ignorerepeated</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;$\mathrm{Wavelength\;[nm]}$&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;$\mathrm{Flux}\; [\mathrm{erg\;s^{-1}\;cm^{-2}\;nm^{-1}}]$&quot;</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">])</span>

<span class="n">xvals</span> <span class="o">=</span> <span class="kt">LinRange</span><span class="p">(</span><span class="mf">200.0</span><span class="p">,</span><span class="mf">2000.0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">au</span> <span class="o">=</span> <span class="mf">1.5e13</span>
<span class="n">Rsun</span> <span class="o">=</span> <span class="mf">7e10</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="nb">pi</span><span class="o">*</span><span class="n">spectral_radiance</span><span class="o">.</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span><span class="mi">5772</span><span class="p">)</span><span class="o">/</span><span class="mf">1e7</span><span class="o">/</span><span class="p">(</span><span class="n">au</span><span class="o">/</span><span class="n">Rsun</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">solar_spectrum</span><span class="o">.</span><span class="n">lambda</span><span class="p">,</span> <span class="n">solar_spectrum</span><span class="o">.</span><span class="n">flux</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/history_23_0.svg" src="../_images/history_23_0.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">gaia_data</span> <span class="o">=</span> <span class="n">CSV</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&quot;gaia_100pc_par_over_err_100.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s">&quot;BP-RP&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s">&quot;G&quot;</span><span class="p">)</span>
<span class="n">color</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="o">.</span><span class="n">phot_bp_mean_mag</span> <span class="o">-</span> <span class="n">gaia_data</span><span class="o">.</span><span class="n">phot_rp_mean_mag</span>
<span class="n">distance_pc</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">./</span> <span class="p">(</span><span class="mf">1e-3</span><span class="o">.*</span><span class="n">gaia_data</span><span class="o">.</span><span class="n">parallax</span><span class="p">)</span>
<span class="n">abs_G</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="o">.</span><span class="n">phot_g_mean_mag</span> <span class="o">.-</span> <span class="mi">5</span> <span class="o">.*</span> <span class="p">(</span><span class="n">log10</span><span class="o">.</span><span class="p">(</span><span class="n">distance_pc</span><span class="p">)</span><span class="o">.-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">G_sun</span> <span class="o">=</span> <span class="mf">4.67</span>
<span class="n">BP_sun</span> <span class="o">=</span> <span class="n">G_sun</span><span class="o">+</span><span class="mf">0.33</span>
<span class="n">RP_sun</span> <span class="o">=</span> <span class="n">G_sun</span><span class="o">-</span><span class="mf">0.49</span>

<span class="n">scatter!</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">abs_G</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Gaia&quot;</span><span class="p">)</span>
<span class="n">scatter!</span><span class="p">([</span><span class="n">BP_sun</span><span class="o">-</span><span class="n">RP_sun</span><span class="p">],[</span><span class="n">G_sun</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;Sun&quot;</span><span class="p">)</span>
<span class="n">yflip!</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/history_24_0.svg" src="../_images/history_24_0.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">flux_ratio_BP_RP</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="c"># Ignoring constant in the integration, relying on bins being equally spaced in lambda</span>
    <span class="n">F_sun_BP</span> <span class="o">=</span> <span class="n">sum</span><span class="p">(</span><span class="n">passbands</span><span class="o">.</span><span class="n">BP_pb</span> <span class="o">.*</span> <span class="n">normalized_spectral_radiance</span><span class="o">.</span><span class="p">(</span><span class="n">passbands</span><span class="o">.</span><span class="n">lambda</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
    <span class="n">F_sun_RP</span> <span class="o">=</span> <span class="n">sum</span><span class="p">(</span><span class="n">passbands</span><span class="o">.</span><span class="n">RP_pb</span> <span class="o">.*</span> <span class="n">normalized_spectral_radiance</span><span class="o">.</span><span class="p">(</span><span class="n">passbands</span><span class="o">.</span><span class="n">lambda</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">F_sun_BP</span><span class="o">/</span><span class="n">F_sun_RP</span>
<span class="k">end</span>

<span class="n">diff_zero_point_BP_RP</span> <span class="o">=</span> <span class="mf">0.82</span><span class="o">+</span><span class="mf">2.5</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="n">flux_ratio_BP_RP</span><span class="p">(</span><span class="mi">5772</span><span class="p">))</span>

<span class="c"># sample </span>
<span class="n">log10_T_sample</span> <span class="o">=</span> <span class="kt">LinRange</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">6.0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">BP_sub_RP</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.5</span><span class="o">*</span><span class="n">log10</span><span class="o">.</span><span class="p">(</span><span class="n">flux_ratio_BP_RP</span><span class="o">.</span><span class="p">(</span><span class="mi">10</span> <span class="o">.^</span> <span class="n">log10_T_sample</span><span class="p">))</span> <span class="o">.+</span> <span class="n">diff_zero_point_BP_RP</span>

<span class="n">plot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;</span><span class="si">$log_</span><span class="s">{10} T_\mathrm{eff}$&quot;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;</span><span class="si">$m_</span><span class="s">\mathrm{BP}-m_\mathrm{RP}$&quot;</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">log10_T_sample</span><span class="p">,</span> <span class="n">BP_sub_RP</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="ne">MethodError</span>: objects of type Int64 are not callable
<span class="n">Maybe</span> <span class="n">you</span> <span class="n">forgot</span> <span class="n">to</span> <span class="n">use</span> <span class="n">an</span> <span class="n">operator</span> <span class="n">such</span> <span class="k">as</span> <span class="o">*</span><span class="p">,</span> <span class="o">^</span><span class="p">,</span> <span class="o">%</span><span class="p">,</span> <span class="o">/</span> <span class="n">etc</span><span class="o">.</span> <span class="o">?</span>

<span class="ne">Stacktrace</span>:
 <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">flux_ratio_BP_RP</span><span class="p">(</span><span class="n">T</span><span class="p">::</span><span class="n">Int64</span><span class="p">)</span>
   <span class="o">@</span> <span class="n">Main</span> <span class="o">./</span><span class="n">In</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span><span class="mi">3</span>
 <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">top</span><span class="o">-</span><span class="n">level</span> <span class="n">scope</span>
   <span class="o">@</span> <span class="n">In</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span><span class="mi">8</span>
 <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="nb">eval</span>
   <span class="o">@</span> <span class="o">./</span><span class="n">boot</span><span class="o">.</span><span class="n">jl</span><span class="p">:</span><span class="mi">368</span> <span class="p">[</span><span class="n">inlined</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="n">include_string</span><span class="p">(</span><span class="n">mapexpr</span><span class="p">::</span><span class="n">typeof</span><span class="p">(</span><span class="n">REPL</span><span class="o">.</span><span class="n">softscope</span><span class="p">),</span> <span class="n">mod</span><span class="p">::</span><span class="n">Module</span><span class="p">,</span> <span class="n">code</span><span class="p">::</span><span class="n">String</span><span class="p">,</span> <span class="n">filename</span><span class="p">::</span><span class="n">String</span><span class="p">)</span>
   <span class="o">@</span> <span class="n">Base</span> <span class="o">./</span><span class="n">loading</span><span class="o">.</span><span class="n">jl</span><span class="p">:</span><span class="mi">1428</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c">#bisection algorithm to get Teff from BP-RP</span>
<span class="k">function</span> <span class="n">log10_T_from_BP_sub_RP</span><span class="p">(</span><span class="n">BP_sub_RP</span><span class="p">)</span>
    <span class="n">log10_T_min</span> <span class="o">=</span> <span class="mf">3.0</span>
    <span class="n">log10_T_max</span> <span class="o">=</span> <span class="mf">6.0</span>
    <span class="n">log10_T</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">while</span> <span class="n">abs</span><span class="p">(</span><span class="n">log10_T_min</span><span class="o">-</span><span class="n">log10_T_max</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.001</span>
        <span class="n">log10_T</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">log10_T_max</span> <span class="o">+</span> <span class="n">log10_T_min</span><span class="p">)</span>
        <span class="n">BP_sub_RP_new</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.5</span><span class="o">*</span><span class="n">log10</span><span class="o">.</span><span class="p">(</span><span class="n">flux_ratio_BP_RP</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="n">log10_T</span><span class="p">))</span> <span class="o">.+</span> <span class="n">diff_zero_point_BP_RP</span>
        <span class="k">if</span> <span class="n">BP_sub_RP_new</span> <span class="o">&gt;</span> <span class="n">BP_sub_RP</span> <span class="c"># T too low, update lower limit</span>
            <span class="n">log10_T_min</span> <span class="o">=</span> <span class="n">log10_T</span>
        <span class="k">else</span> <span class="c"># otherwise, update upper limit</span>
            <span class="n">log10_T_max</span> <span class="o">=</span> <span class="n">log10_T</span>
        <span class="k">end</span>
    <span class="k">end</span>
    <span class="k">return</span> <span class="n">log10_T</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>log10_T_from_BP_sub_RP (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">log10_T</span> <span class="o">=</span> <span class="n">log10_T_from_BP_sub_RP</span><span class="o">.</span><span class="p">(</span><span class="n">color</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;$\log_{10}T_\mathrm{eff}$&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s">&quot;G&quot;</span><span class="p">)</span>

<span class="n">scatter!</span><span class="p">(</span><span class="n">log10_T</span><span class="p">,</span> <span class="n">abs_G</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Gaia&quot;</span><span class="p">)</span>
<span class="n">scatter!</span><span class="p">([</span><span class="n">log10_T_from_BP_sub_RP</span><span class="p">(</span><span class="n">BP_sun</span><span class="o">-</span><span class="n">RP_sun</span><span class="p">)],[</span><span class="n">G_sun</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Sun&quot;</span><span class="p">)</span>
<span class="n">yflip!</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
<span class="n">xflip!</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/history_28_0.svg" src="../_images/history_28_0.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">flux_ratio_G_total</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="c"># Ignoring constant in the integration, relying on bins being equally spaced in lambda</span>
    <span class="n">F_G</span> <span class="o">=</span> <span class="n">sum</span><span class="p">(</span><span class="n">passbands</span><span class="o">.</span><span class="n">BP_pb</span> <span class="o">.*</span> <span class="n">spectral_radiance</span><span class="o">.</span><span class="p">(</span><span class="n">passbands</span><span class="o">.</span><span class="n">lambda</span><span class="p">,</span><span class="n">T</span><span class="p">)</span> <span class="o">.*</span><span class="mf">1e-7</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">π</span><span class="o">*</span><span class="n">F_G</span><span class="o">/</span><span class="p">(</span><span class="n">σ</span><span class="o">*</span><span class="n">T</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">plot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;</span><span class="si">$log_</span><span class="s">{10} T_\mathrm{eff}$&quot;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;</span><span class="si">$F_</span><span class="s">\mathrm{G}/F$&quot;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="ss">:log</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">log10_T_sample</span><span class="p">,</span> <span class="n">flux_ratio_G_total</span><span class="o">.</span><span class="p">(</span><span class="mi">10</span> <span class="o">.^</span> <span class="n">log10_T_sample</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/history_29_0.svg" src="../_images/history_29_0.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c">#log10_L_div_Lsun = (G_sun .- abs_G)./(2.5) .-</span>
<span class="c">#    log10.(flux_ratio_G_total.(10 .^ log10_T)) .+ log10.(flux_ratio_G_total.(5772));</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c">#plot(xlabel=L&quot;$\log_{10}T_\mathrm{eff}$&quot;, ylabel=L&quot;\log_{10}L/L_\odot&quot;)</span>
<span class="c">#</span>
<span class="c">## Predicted Zero-age main-sequence location for stars of masses (in Msun):</span>
<span class="c">##     0.4, 0.8, 0.9, 1.0, 1.25, 1.5, 1.7, 2, 2.5</span>
<span class="c">## All models except those with M=0.4 Msun are from Schaller et al. (1992):</span>
<span class="c">## - https://ui.adsabs.harvard.edu/abs/1992A%26AS...96..269S/abstract</span>
<span class="c">## Model at 0.4 Msun is from Charbonnel et al. (1999):</span>
<span class="c">## - https://ui.adsabs.harvard.edu/abs/1999A%26AS..135..405C/abstract</span>
<span class="c">#log10_T_geneva = [3.568, 3.687, 3.724, 3.751, 3.808, 3.852, 3.901, 3.958, 4.031]</span>
<span class="c">#log10_L_geneva = [-1.63, -0.612, -0.394, -0.163, 0.325, 0.676, 0.916, 1.209, 1.600]</span>
<span class="c">#</span>
<span class="c">#scatter!(log10_T, log10_L_div_Lsun, label=&quot;Gaia&quot;)</span>
<span class="c">##scatter!(log10_T, (G_sun .- abs_G)./(-2.5))</span>
<span class="c">#scatter!([log10_T_from_BP_sub_RP(BP_sun-RP_sun)],[0], label=&quot;Sun&quot;)</span>
<span class="c">#plot!(log10_T_geneva, log10_L_geneva, linewidth=5, linestyle= :dot, color=&quot;orange&quot;, label=&quot;ZAMS&quot;)</span>
<span class="c">#xflip!(true)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/history_31_0.svg" src="../_images/history_31_0.svg" /></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.8"
        },
        kernelOptions: {
            kernelName: "julia-1.8",
            path: "./history"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.8'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../instructions/instructions.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">1. </span>Instructions</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../equations/equations.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">3. </span>The equations of stellar structure and evolution</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Pablo Marchant & Annachiara Picco<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>