
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>2. Some history &#8212; Stellar Structure and Evolution</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. The equations of stellar structure and evolution" href="../equations/equations.html" />
    <link rel="prev" title="1. Instructions" href="../instructions/instructions.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Stellar Structure and Evolution</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../instructions/instructions.html">
   1. Instructions
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   2. Some history
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../equations/equations.html">
   3. The equations of stellar structure and evolution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../eos1/eos1.html">
   4. The energy equation and the equation of state
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../eos2/eos2.html">
   5. Degenerate equations of state
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../radiative/radiative.html">
   6. Radiative and conductive energy transport
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../bibliography.html">
   7. Bibliography
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/orlox/stars_2022_2023/main?urlpath=tree/history/history.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/orlox/stars_2022_2023"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/orlox/stars_2022_2023/issues/new?title=Issue%20on%20page%20%2Fhistory/history.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/history/history.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pen-paper-exercises">
   2.1. Pen &amp; paper exercises
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#timescales-of-stellar-evolution">
     2.1.1. Timescales of stellar evolution
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solution-to-pen-paper-exercises">
   2.2. Solution to pen &amp; paper exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#julia-basics">
   2.3. Julia basics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#constructing-an-hr-diagram-with-gaia-data">
     2.3.1. Constructing an HR diagram with Gaia data
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Some history</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pen-paper-exercises">
   2.1. Pen &amp; paper exercises
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#timescales-of-stellar-evolution">
     2.1.1. Timescales of stellar evolution
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solution-to-pen-paper-exercises">
   2.2. Solution to pen &amp; paper exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#julia-basics">
   2.3. Julia basics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#constructing-an-hr-diagram-with-gaia-data">
     2.3.1. Constructing an HR diagram with Gaia data
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="some-history">
<h1><span class="section-number">2. </span>Some history<a class="headerlink" href="#some-history" title="Permalink to this headline">#</a></h1>
<section id="pen-paper-exercises">
<h2><span class="section-number">2.1. </span>Pen &amp; paper exercises<a class="headerlink" href="#pen-paper-exercises" title="Permalink to this headline">#</a></h2>
<section id="timescales-of-stellar-evolution">
<h3><span class="section-number">2.1.1. </span>Timescales of stellar evolution<a class="headerlink" href="#timescales-of-stellar-evolution" title="Permalink to this headline">#</a></h3>
<p>There are three main timescales in which stars evolve. These are the dynamical, thermal and nuclear timescales. Even without knowing the equations of stellar structure and evolution we can do some estimates on the value of these quantities. Compute these without a calculator! We only care about the order of magnitude of these timescales, which given all the approximations done is all we can do. For solar properties, use the following for the mass, radius and luminosity:</p>
<div class="math notranslate nohighlight">
\[R_\odot\sim 7\times 10^{10}\;\mathrm{[cm]},\quad M_\odot \sim 2\times 10^{33}\;\mathrm{[g]},\quad L_\odot \sim 4\times 10^{33}\;\mathrm{[erg\;s^{-1}]}\]</div>
<ul>
<li><p>Thermal timescale: One of the main early hypothesis to explain the energy source of the Sun was that it originated from its slow contraction into its own gravitational potential. In such a case, a rough estimate of the energy the Sun would have radiated through its life is given by the negative of the gravitational potential energy <span class="math notranslate nohighlight">\(E_\mathrm{g}\)</span>:</p>
<div class="math notranslate nohighlight">
\[E_\mathrm{g} \sim -\frac{GM_\odot^2}{R_\odot}.\]</div>
<p>Assuming that the luminosity of the Sun has always been its current one, <span class="math notranslate nohighlight">\(L_\odot\)</span>, compute the age of the Sun under the assumption that it is only powered by contraction.</p>
</li>
<li><p>Dynamical timescale: For most of their lives stars are very close to hydrostatic equilibrium, carefully balancing their gravities against the support of a pressure gradient. Whenever these two forces are misbalanced, the star will evolve in what is known as the dynamical timescale. Estimate this timescale by computing the time it would take for the surface of the sun to free-fall all the way to its center if all forces opposing gravity would be removed. For simplicity assume that the gravitational acceleration is constant and equal to its present one.</p></li>
<li><p>Nuclear timescale: As we now know, most stars are powered by nuclear reactions. Masses of isotopes are normally given in terms of the atomic mass unit <span class="math notranslate nohighlight">\(m_\mathrm{u}=1.661\times 10^{-24}\;\mathrm{g}\)</span>, defined as <span class="math notranslate nohighlight">\(1/12\)</span> of the mass of a carbon-12 atom. The mass of a hydrogen atom is <span class="math notranslate nohighlight">\(m_\mathrm{H}=1.007825m_\mathrm{u}\)</span> and that of a helium atom is <span class="math notranslate nohighlight">\(m_\mathrm{He}=4.002602 m_\mathrm{u}\)</span>, such that if four hydrogen atoms are fused into a helium atom there is a mass deficit leading to a release of energy <span class="math notranslate nohighlight">\((4m_\mathrm{H}-m_\mathrm{He})c^2\sim 4\times 10^{-5}\;\mathrm{[erg]}\)</span>. With this information, estimate the lifetime of the Sun as a core-hydrogen burning star. For simplicity, assume the Sun has a constant luminosity and is entirely composed of hydrogen, 10% of which is burned into Helium during core-hydrogen burning.</p></li>
</ul>
</section>
</section>
<section id="solution-to-pen-paper-exercises">
<h2><span class="section-number">2.2. </span>Solution to pen &amp; paper exercises<a class="headerlink" href="#solution-to-pen-paper-exercises" title="Permalink to this headline">#</a></h2>
</section>
<section id="julia-basics">
<h2><span class="section-number">2.3. </span>Julia basics<a class="headerlink" href="#julia-basics" title="Permalink to this headline">#</a></h2>
<p>For the first class we provide a computational example rather than exercises. All computational exercises will be shown using the <a class="reference external" href="https://julialang.org/"><em>julia</em></a> programming language, but the code provided can be easily translated to other languages such as python. The main benefit of julia is that it is a language that is simple to write but can still have a performance comparable to traditional compiled languages. A good overview of the language can be found in the official <a class="reference external" href="https://docs.julialang.org/en/v1/manual/getting-started/">manual</a>, but below we show some of the basic functionality that you will need to use.</p>
<p>First of all, we illustrate the basic usage of julia. A normal thing you will do at the beginning of any notebook or program is to include packages. Our life is made significantly easier by people who provide these packages! To do this, one makes use of the <code class="docutils literal notranslate"><span class="pre">using</span></code> keyword. Below we include the packages we will be using in this example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="n">DataFrames</span>     <span class="c"># Used to deal with tabular data</span>
<span class="k">using</span> <span class="n">Plots</span>          <span class="c"># Provides a multitude of plotting routines</span>
<span class="k">using</span> <span class="n">CSV</span>            <span class="c"># Efficient reading of files in &quot;comma separated values&quot; format</span>
<span class="k">using</span> <span class="n">LaTeXStrings</span>   <span class="c"># Makes it easy to write LaTeX strings</span>
</pre></div>
</div>
</div>
</div>
<p>Whenever you work on a fresh environment you will find the above code fails, as the packages are not installed. As described in the error message you can correct this by running (in a different cell) <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">Pkg;</span> <span class="pre">Pkg.add(&quot;DataFrames&quot;)</span></code>, and similarly for the other packages. Once this is done for a package, it will remain installed in your environment, and you don’t need to use <code class="docutils literal notranslate"><span class="pre">Pkg.add</span></code> again (it is safe to erase the cells with that command).</p>
<p>The syntax of julia should be familiar to those with a python background. Assigning numerical variables and performing arithmetic operations on them is straightforward.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">b</span> <span class="o">=</span> <span class="nb">pi</span> <span class="c"># the definition of pi is included by default</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span> <span class="c"># addition</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">b</span><span class="o">^</span><span class="n">a</span> <span class="c"># exponentiation</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="c"># basic mathematical functions are also defined in the language, no need to include a package</span>

<span class="n">print</span><span class="p">(</span><span class="s">&quot;c=</span><span class="si">$</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="s">, b=</span><span class="si">$</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="s">, c=</span><span class="si">$</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="s">&quot;</span><span class="p">)</span> <span class="c"># $() notation is used to read the value in parenthesis into the string</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c=5.141592653589793, b=9.869604401089358, c=0.0
</pre></div>
</div>
</div>
</div>
<p>One option that can let you increase the readability of code is the use of greek characters. To include these in a code block you can write <code class="docutils literal notranslate"><span class="pre">\beta</span></code> and then press tab, which will replace them with the corresponding greek character.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">β</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>  <span class="c"># Using &#39;;&#39; at the end of a line will hide its output</span>
</pre></div>
</div>
</div>
</div>
<p>You also have access to basic keywords for control flow, including <code class="docutils literal notranslate"><span class="pre">if</span></code> blocks and <code class="docutils literal notranslate"><span class="pre">for</span></code> loops. Here some small notational variations arise with respect to <code class="docutils literal notranslate"><span class="pre">python</span></code>. Blocks of code are not defined by indentation but by the use of the <code class="docutils literal notranslate"><span class="pre">end</span></code> keyword.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">3</span>

<span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">2</span>   <span class="c"># &amp;&amp; stands for &#39;and&#39;</span>
    <span class="n">print</span><span class="p">(</span><span class="s">&quot;if was successful&quot;</span><span class="p">)</span>
<span class="k">elseif</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">||</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">2</span>   <span class="c"># || stands for &#39;or&#39;</span>
    <span class="n">print</span><span class="p">(</span><span class="s">&quot;elseif was successful&quot;</span><span class="p">)</span>
<span class="k">else</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Neither if or elseif were successful&quot;</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span> <span class="c"># print a line break</span>

<span class="c"># Add up all digits between 1 and 10 using a for loop</span>
<span class="n">summation</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="mi">10</span>
    <span class="n">summation</span> <span class="o">=</span> <span class="n">summation</span><span class="o">+</span><span class="n">i</span>
<span class="k">end</span>
<span class="n">print</span><span class="p">(</span><span class="s">&quot;Adding all numbers between 1 and 10 gives us </span><span class="si">$</span><span class="p">(</span><span class="n">sum</span><span class="p">)</span><span class="s">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>elseif was successful
Adding all numbers between 1 and 10 gives us sum
</pre></div>
</div>
</div>
</div>
<p>We can also define functions using the <code class="docutils literal notranslate"><span class="pre">function</span></code> keyword.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">add1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span>
<span class="k">end</span>

<span class="n">add1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<p>We often deal not just with scalars but also vectors or matrices. We can define a vector covering a range of values using the <code class="docutils literal notranslate"><span class="pre">LinRange</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">xvals</span> <span class="o">=</span> <span class="kt">LinRange</span><span class="p">(</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span> <span class="c"># Create a vector with elements from -5.0 to 5.0 with 11 elements.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11-element LinRange{Float64, Int64}:
 -5.0,-4.0,-3.0,-2.0,-1.0,0.0,1.0,2.0,3.0,4.0,5.0
</pre></div>
</div>
</div>
</div>
<p>Contrary to python, arrays in julia start at position 1, so if you attempt to access <code class="docutils literal notranslate"><span class="pre">xvals[0]</span></code> you will get an error.</p>
<p>Beware that many operations on vectors will not work as you might naively expect. If you try computing <code class="docutils literal notranslate"><span class="pre">xvals^2</span></code>, an error will be thrown as the <code class="docutils literal notranslate"><span class="pre">^</span></code> operation is not defined between a vector and an integer. You could think that the above operation is ambiguous, do we mean that we want to take the square of each element of the vector or instead that we want to take the dot product of xvals with itself? To explicitly state that an operation is meant to be done element by element, one can use a <code class="docutils literal notranslate"><span class="pre">.</span></code> before the operation. Further information on this notation can be found <a class="reference external" href="https://docs.julialang.org/en/v1/manual/functions/#man-vectorized">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">xvals</span><span class="o">.^</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11-element Vector{Float64}:
 25.0
 16.0
  9.0
  4.0
  1.0
  0.0
  1.0
  3.999999999999999
  9.0
 16.0
 25.0
</pre></div>
</div>
</div>
</div>
<p>This can be done with any function. For instance the code below will apply our <code class="docutils literal notranslate"><span class="pre">add1</span></code> function to each element of the array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">add1</span><span class="o">.</span><span class="p">(</span><span class="n">xvals</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11-element Vector{Float64}:
 -4.0
 -3.0
 -2.0
 -1.0
  0.0
  1.0
  2.0
  3.0
  4.0
  5.0
  6.0
</pre></div>
</div>
</div>
</div>
<p>Finally, the <code class="docutils literal notranslate"><span class="pre">Plots</span></code> package allows us to easily make different kinds of plots. The example below shows a (sparsely) sampled plot of sine and cosine. The plot can be created by calling the <code class="docutils literal notranslate"><span class="pre">plot(...)</span></code> function, while things are added to it by calling the <code class="docutils literal notranslate"><span class="pre">plot!()</span></code> function. Using <code class="docutils literal notranslate"><span class="pre">!</span></code> as part of a function name is part of the style guide of julia to identify functions which modify their arguments. For example, the <code class="docutils literal notranslate"><span class="pre">sort(x)</span></code> function will return a copy of the vector <code class="docutils literal notranslate"><span class="pre">x</span></code> which is sorted, while <code class="docutils literal notranslate"><span class="pre">sort!(x)</span></code> will modify the vector <code class="docutils literal notranslate"><span class="pre">x</span></code> into a sorted version of itself (known as in place sorting).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">yvals</span> <span class="o">=</span> <span class="n">sin</span><span class="o">.</span><span class="p">(</span><span class="n">xvals</span><span class="p">)</span>
<span class="n">yvals2</span> <span class="o">=</span> <span class="n">cos</span><span class="o">.</span><span class="p">(</span><span class="n">xvals</span><span class="p">)</span>
<span class="c"># The LaTeX strings package allows us to write LaTeX without needing to escape backslashes</span>
<span class="c"># (i.e., we can write L&quot;\sin(x)&quot; instead of &quot;$\\sin(x)$&quot;).</span>
<span class="n">plot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;</span><span class="si">$x</span><span class="s">$&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;</span><span class="si">$y</span><span class="s">$&quot;</span><span class="p">)</span> 
<span class="n">plot!</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">yvals</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;$\sin(x)$&quot;</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">yvals2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;$\cos(x)$&quot;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="ss">:dash</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/history_20_0.svg" src="../_images/history_20_0.svg" /></div>
</div>
<section id="constructing-an-hr-diagram-with-gaia-data">
<h3><span class="section-number">2.3.1. </span>Constructing an HR diagram with Gaia data<a class="headerlink" href="#constructing-an-hr-diagram-with-gaia-data" title="Permalink to this headline">#</a></h3>
<p>To run this lab locally you will need three additional files, <a class="reference download internal" download="" href="../_downloads/16c58f2fe7fdef623d4fec7ec4b143fa/solar_spectrum.dat"><code class="xref download docutils literal notranslate"><span class="pre">solar_spectrum.dat</span></code></a>, <a class="reference download internal" download="" href="../_downloads/990f67d18958a317ab97bf38e2b36586/gaia_100pc_par_over_err_100.csv"><code class="xref download docutils literal notranslate"><span class="pre">gaia_100pc_par_over_err_100.csv</span></code></a> and <a class="reference download internal" download="" href="../_downloads/73382180c6f76469a6680ea8eb565519/passband.dat"><code class="xref download docutils literal notranslate"><span class="pre">passband.dat</span></code></a>.</p>
<p>The radiation coming out of a star can be approximated to first order using black body radiation. In this case the intensity is described by Planck’s law,</p>
<div class="math notranslate nohighlight">
\[B_\lambda(\lambda,T) = \frac{2h c^2}{\lambda^5}\frac{1}{\exp\left(\frac{hc}{\lambda k_\mathrm{B}T}\right)-1},\]</div>
<p>which describes the energy flux per unit area and unit solid angle. This function peaks at a value of <span class="math notranslate nohighlight">\(\lambda_\mathrm{max}=hc/(4.965 k_\mathrm{B}T)\)</span>. We can use this to normalize the distribution such that its peak value is <span class="math notranslate nohighlight">\(1\)</span>, which is useful for visualization. Below we define both <span class="math notranslate nohighlight">\(B_\lambda\)</span> and its normalized version.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="mf">6.6261e-27</span>      <span class="c"># Planck&#39;s constant, cm^2 g s^-1</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">2.99792458e10</span>   <span class="c"># speed of light cm s^-1</span>
<span class="n">k_B</span> <span class="o">=</span> <span class="mf">1.3807e-16</span>    <span class="c"># Boltzmann constant erg K-1</span>
<span class="n">σ</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="nb">π</span><span class="o">^</span><span class="mi">5</span><span class="o">*</span><span class="n">k_B</span><span class="o">^</span><span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="mi">15</span><span class="o">*</span><span class="n">h</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">c</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="c"># Stefan-Boltzmann constant</span>
<span class="k">function</span> <span class="n">B_λ</span><span class="p">(</span><span class="n">λ</span><span class="p">,</span><span class="n">T</span><span class="p">)</span> <span class="c">#λ in nm, T in Kelvin</span>
    <span class="n">λ_cm</span> <span class="o">=</span> <span class="n">λ</span><span class="o">*</span><span class="mf">1e-7</span>
    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">c</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">λ_cm</span><span class="o">^</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="n">λ_cm</span><span class="o">*</span><span class="n">k_B</span><span class="o">*</span><span class="n">T</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="k">end</span><span class="p">;</span>
<span class="k">function</span> <span class="n">normalized_B_λ</span><span class="p">(</span><span class="n">λ</span><span class="p">,</span><span class="n">T</span><span class="p">)</span> <span class="c">#λ in nm, T in Kelvin</span>
    <span class="n">peak_λ</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="mf">4.965</span><span class="o">*</span><span class="n">k_B</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="mf">1e7</span> <span class="c">#in nm</span>
    <span class="k">return</span> <span class="n">B_λ</span><span class="p">(</span><span class="n">λ</span><span class="p">,</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="n">B_λ</span><span class="p">(</span><span class="n">peak_λ</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>To see what we mean when we say the spectrum of a star resembles that of a black body, we can check a solar spectrum. The flux that would come out of the surface of the sun per unit wavelength can be obtained by integration of <span class="math notranslate nohighlight">\(B_\lambda\)</span> over a half sphere, with a <span class="math notranslate nohighlight">\(\cos(\theta)\)</span> correction to account for projection effects,</p>
<div class="math notranslate nohighlight">
\[F_\lambda = \int_0^{2 \pi}d\phi\int_0^{\pi/2}B_\lambda(\lambda,T)\cos(\theta)\sin(\theta) d\theta d\phi=\pi B_\lambda.\]</div>
<p>Integrated over all wavelengths it can be shown that the total flux is given by <span class="math notranslate nohighlight">\(F=\sigma T^4\)</span>, where <span class="math notranslate nohighlight">\(\sigma\)</span> is the Stefan-Boltzmann constant. While travelling through vacuum the flux scales as the inverse of the square distance, such that the solar flux observed at Earth can be computed as</p>
<div class="math notranslate nohighlight">
\[F_{\lambda,\mathrm{Earth}} = \pi B_\lambda \left(\frac{R_\odot}{1\;\mathrm{[au]}}\right)^2.\]</div>
<p>Below we compare this black body prediction to a <a class="reference external" href="https://www.nrel.gov/grid/solar-resource/spectra-astm-e490.html">standard solar spectrum</a> from the National Renewable Energy Laboratory of the US. Here we use a temperature of <span class="math notranslate nohighlight">\(T_\mathrm{eff}=5772\;\mathrm{K}\)</span> for the Sun, which is a standard value defined by the <a class="reference external" href="https://www.iau.org/static/resolutions/IAU2015_English.pdf">International Astronomical Union</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span> <span class="c"># We read a CSV file into a dataframe. The first line of the file contains the column names</span>
<span class="n">solar_spectrum</span> <span class="o">=</span> <span class="n">CSV</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&quot;solar_spectrum.dat&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">delim</span><span class="o">=</span><span class="s">&quot; &quot;</span><span class="p">,</span> <span class="n">ignorerepeated</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;$\mathrm{Wavelength\;[nm]}$&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;$\mathrm{Flux}\; [\mathrm{erg\;s^{-1}\;cm^{-2}\;nm^{-1}}]$&quot;</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">])</span>

<span class="n">xvals</span> <span class="o">=</span> <span class="kt">LinRange</span><span class="p">(</span><span class="mf">200.0</span><span class="p">,</span><span class="mf">2000.0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">au</span> <span class="o">=</span> <span class="mf">1.5e13</span>
<span class="n">Rsun</span> <span class="o">=</span> <span class="mf">7e10</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="nb">pi</span><span class="o">*</span><span class="n">B_λ</span><span class="o">.</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span><span class="mi">5772</span><span class="p">)</span><span class="o">/</span><span class="mf">1e7</span><span class="o">/</span><span class="p">(</span><span class="n">au</span><span class="o">/</span><span class="n">Rsun</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="c"># 1e7 factor converts from centimeter to nanometer</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">solar_spectrum</span><span class="o">.</span><span class="n">lambda</span><span class="p">,</span> <span class="n">solar_spectrum</span><span class="o">.</span><span class="n">flux</span><span class="p">)</span> <span class="c"># columns in a dataframe can be easily accesible by name</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/history_24_0.svg" src="../_images/history_24_0.svg" /></div>
</div>
<p>In this exercise we will work with <a class="reference external" href="https://www.esa.int/Science_Exploration/Space_Science/Gaia">Gaia</a> data. Gaia is a space mission that is performing astrometry of over a billion targets, providing an incredible picture on the structure of our Galaxy. Using parallaxes we can determine the distance to these stars and thus infer their absolute magnitudes. Gaia also provides photometric measurements in three bands, called <span class="math notranslate nohighlight">\(G\)</span>, <span class="math notranslate nohighlight">\(G_{RP}\)</span> and <span class="math notranslate nohighlight">\(G_{BP}\)</span>. The G band is a broadband filter, while the <span class="math notranslate nohighlight">\(G_{RP}\)</span> and <span class="math notranslate nohighlight">\(G_{BP}\)</span> filters are more sensitive to short and long wavelengths respectively. The sensitivity of each filter to light at different wavelengths is described by the passbands, which are shown below compared to a (normalized) black body spectrum with the effective temperature of the Sun. For simplicity from here on we refer to the <span class="math notranslate nohighlight">\(G_{RP}\)</span> and <span class="math notranslate nohighlight">\(G_{BP}\)</span> filters as RP and BP.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">passbands</span> <span class="o">=</span> <span class="n">CSV</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&quot;passband.dat&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">delim</span><span class="o">=</span><span class="s">&quot; &quot;</span><span class="p">,</span> <span class="n">ignorerepeated</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;$\mathrm{Wavelength\;[nm]}$&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;\mathrm{Transmissivity}&quot;</span><span class="p">,</span> <span class="n">legendfontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">passbands</span><span class="o">.</span><span class="n">lambda</span><span class="p">,</span> <span class="n">passbands</span><span class="o">.</span><span class="n">G_pb</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;</span><span class="si">$G</span><span class="s">$&quot;</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">passbands</span><span class="o">.</span><span class="n">lambda</span><span class="p">,</span> <span class="n">passbands</span><span class="o">.</span><span class="n">BP_pb</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;BP&quot;</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">passbands</span><span class="o">.</span><span class="n">lambda</span><span class="p">,</span> <span class="n">passbands</span><span class="o">.</span><span class="n">RP_pb</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;RP&quot;</span><span class="p">)</span>

<span class="n">xvals</span> <span class="o">=</span> <span class="kt">LinRange</span><span class="p">(</span><span class="mf">200.0</span><span class="p">,</span><span class="mf">1500.0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">normalized_B_λ</span><span class="o">.</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span><span class="mi">5772</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;</span><span class="si">$T</span><span class="s">=5772\;\mathrm{[K]}$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/history_26_0.svg" src="../_images/history_26_0.svg" /></div>
</div>
<p>The <a class="reference external" href="https://gea.esac.esa.int/archive/">Gaia archive</a> gives us a nice interface to query results from this mission (although queries are limited to 2000 results). Here we read a file <code class="docutils literal notranslate"><span class="pre">gaia_100pc_par_over_err_100.csv</span></code> that containts a sample of stars within <span class="math notranslate nohighlight">\(100\)</span> parsecs for which the error in the measured parallax is smaller that <span class="math notranslate nohighlight">\(1\%\)</span> of the total. As a quick reminder on what parallax means, it refers to the angular displacement of stars as seen by two different observers. When this angle is taken between two measurements at opposite ends of a circle with a distance of <span class="math notranslate nohighlight">\(1\;\mathrm{au}\)</span> (so, for an observer on Earth), the parallax <span class="math notranslate nohighlight">\(p\)</span> is half the of the angular displacement measured against a background of distant “fixed” stars. A parsec corresponds to the distance at which a source has a parallax of <span class="math notranslate nohighlight">\(1''\)</span> (<span class="math notranslate nohighlight">\(''\)</span> stands for arcsecond, which corresponds to <span class="math notranslate nohighlight">\(1/(60\times 3600)\)</span> of a degree). In this way the distance of a source is given by</p>
<div class="math notranslate nohighlight">
\[\frac{d}{1\;\mathrm{[pc]}} = \frac{1}{p/1''}.\]</div>
<p>Knowing the distance we can compute the absolute magnitude <span class="math notranslate nohighlight">\(M\)</span> of a star of known apparent magnitude <span class="math notranslate nohighlight">\(m\)</span>,</p>
<div class="math notranslate nohighlight">
\[M=m-5(\log_{10}d_\mathrm{pc}-1),\]</div>
<p>where <span class="math notranslate nohighlight">\(d_\mathrm{pc}\)</span> is the distance to the source in parsecs. Using this, below we read the datafile obtained from the Gaia archive, compute the absolute G magnitude of each object using the distance obtained from the parallax (note that the parallaxes are in units of milliarcseconds), and plot a Hertzsprung-Russell diagram. The x-coordinate of the diagram is the color, obtained from substracting the magnitudes on the BP and RP filters. As lower magnitudes imply higher flux, sources to the left of the diagram have a bluer spectrum. We also include in here the location of the Sun using the values provided by <span id="id1">[<a class="reference internal" href="../bibliography.html#id3" title="L. Casagrande and Don A. VandenBerg. On the use of Gaia magnitudes and new tables of bolometric corrections. \mnras , 479(1):L102-L107, September 2018. arXiv:1806.01953, doi:10.1093/mnrasl/sly104.">Casagrande and VandenBerg, 2018</a>]</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">gaia_data</span> <span class="o">=</span> <span class="n">CSV</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&quot;gaia_100pc_par_over_err_100.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;</span><span class="si">$m_</span><span class="s">{BP}-m_{RP}$&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s">&quot;Absolute G magnitude&quot;</span><span class="p">)</span>
<span class="n">color</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="o">.</span><span class="n">phot_bp_mean_mag</span> <span class="o">-</span> <span class="n">gaia_data</span><span class="o">.</span><span class="n">phot_rp_mean_mag</span>
<span class="n">distance_pc</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">./</span> <span class="p">(</span><span class="mf">1e-3</span><span class="o">.*</span><span class="n">gaia_data</span><span class="o">.</span><span class="n">parallax</span><span class="p">)</span>
<span class="n">abs_G</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="o">.</span><span class="n">phot_g_mean_mag</span> <span class="o">.-</span> <span class="mi">5</span> <span class="o">.*</span> <span class="p">(</span><span class="n">log10</span><span class="o">.</span><span class="p">(</span><span class="n">distance_pc</span><span class="p">)</span><span class="o">.-</span><span class="mi">1</span><span class="p">)</span>

<span class="c"># Solar absolute magnitudes from Casagrande &amp; VandenBerg (2018)</span>
<span class="n">G_sun</span> <span class="o">=</span> <span class="mf">4.67</span>
<span class="n">BP_sun</span> <span class="o">=</span> <span class="n">G_sun</span><span class="o">+</span><span class="mf">0.33</span>
<span class="n">RP_sun</span> <span class="o">=</span> <span class="n">G_sun</span><span class="o">-</span><span class="mf">0.49</span>

<span class="n">scatter!</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">abs_G</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Gaia&quot;</span><span class="p">)</span>
<span class="n">scatter!</span><span class="p">([</span><span class="n">BP_sun</span><span class="o">-</span><span class="n">RP_sun</span><span class="p">],[</span><span class="n">G_sun</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;Sun&quot;</span><span class="p">)</span>
<span class="n">yflip!</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/history_28_0.svg" src="../_images/history_28_0.svg" /></div>
</div>
<p>A lot of interesting structure comes right out of this figure. We have that most stars live in a narrow band which crosses the figure diagonally. This band is the main-sequence, and is populated by core-hydrogen burning stars. On the lower left of the diagram we see an additional band of stars, which are much fainter for a given color. These stars correspond to white dwarfs. Finally, and not so apparent, on the upper left of the main sequence there are a few objects which diverge to higher luminosities than the main sequence. These are stars on their red-giant branch. We will go through all of these types of stars later in this course.</p>
<p>Next up, we want to turn this into a theoretical Hertzprung-Russell diagram which shows the effective temperature <span class="math notranslate nohighlight">\(T_\mathrm{eff}\)</span> versus the luminosity. For this we need to know how to transform the color into an effective temperature, and how to determine the luminosity of a star with a given absolute G band magnitude and color. We will start with the mapping from color to effective temperature. In all of this we will assume all stars radiate as black bodies with an unkown temperature. For a source with a temperature <span class="math notranslate nohighlight">\(T_\mathrm{eff}\)</span> we can compute the magnitude in each band as</p>
<div class="math notranslate nohighlight">
\[m_{BP}=-2.5\log_{10} F_{BP} + m_{0,BP},\quad m_{RP}=-2.5\log_{10} F_{RP} + m_{0,RP},\]</div>
<p>where the fluxes on each band are obtained by integrating a black body spectrum with the corresponding passband (<span class="math notranslate nohighlight">\(\varphi_{BP}(\lambda)\)</span> or <span class="math notranslate nohighlight">\(\varphi_{RP}(\lambda)\)</span>) that were plotted earlier:</p>
<div class="math notranslate nohighlight">
\[F_{BP} = C\int_0^\infty B_\lambda(\lambda,T) \varphi_{BP}(\lambda) d\lambda,\quad F_{RP}=C\int_0^\infty B_\lambda(\lambda,T) \varphi_{RP}(\lambda) d\lambda, \quad C=\pi \left(\frac{R}{d}\right)^2.\]</div>
<p>The two zero-points <span class="math notranslate nohighlight">\(m_{0,BP}\)</span> and <span class="math notranslate nohighlight">\(m_{0,RP}\)</span> form part of the definition of the photometric system. Taking the difference between the magnitudes we obtain the color,</p>
<div class="math notranslate nohighlight" id="equation-zero-point1">
<span class="eqno">(2.1)<a class="headerlink" href="#equation-zero-point1" title="Permalink to this equation">#</a></span>\[m_{BP}-m_{RP} = -2.5 \log_{10}\left(\frac{\int_0^\infty B_\lambda(\lambda,T) \varphi_{BP}(\lambda) d\lambda}{\int_0^\infty B_\lambda(\lambda,T) \varphi_{RP}(\lambda) d\lambda}\right) + m_{0,BP} - m_{0,RP}.\]</div>
<p>Taking the absolute magnitude of the Sun in the BP and RP bands, and assuming it radiates as a black body with <span class="math notranslate nohighlight">\(T=5772\;\mathrm{[K]}\)</span>, the difference between the zero-points can be expressed as (it does not make a difference if we use the absolute or apparent magnitude of the Sun here)</p>
<div class="math notranslate nohighlight" id="equation-zero-point2">
<span class="eqno">(2.2)<a class="headerlink" href="#equation-zero-point2" title="Permalink to this equation">#</a></span>\[m_{0,BP} - m_{0,RP}= M_{BP,\odot}-M_{RP,\odot} + 2.5 \log_{10}\left(\frac{\int_0^\infty B_\lambda(\lambda,5772\;\mathrm{[K]}) \varphi_{BP}(\lambda) d\lambda}{\int_0^\infty B_\lambda(\lambda,5772\;\mathrm{[K]}) \varphi_{RP}(\lambda) d\lambda}\right).\]</div>
<p>Although we are getting the difference in the zero points by using an approximation of the Sun as a black body, a more formal approach would be to use the definition of the zero point of the GAIA photometric system, which uses the VEGAMAG system. In this system the zero points are set such that one particular star, Vega, has a magnitude of zero in all bands (or more specifally, a particular spectral model of Vega satisfies that). However, for this exercise, Vega is not ideal to use because it is a rapidly rotating star which cannot be well approximated with a blackbody spectrum. For details on this, you can check the section on <a class="reference external" href="https://gea.esac.esa.int/archive/documentation/GDR3/Data_processing/chap_cu5pho/cu5pho_sec_photProc/cu5pho_ssec_photCal.html">external calibration</a> from the documentation of the third Gaia data release <span id="id2">[<a class="reference internal" href="../bibliography.html#id4" title="F. van Leeuwen, J. de Bruijne, C. Babusiaux, G. Busso, J. Castañeda, C. Ducourant, C. Fabricius, and et al. Gaia DR3 documentation. Gaia DR3 documentation, European Space Agency; Gaia Data Processing and Analysis Consortium. Online at https://gea.esac.esa.int/archive/documentation/GDR3/index.html, id. 1, June 2022.">van Leeuwen <em>et al.</em>, 2022</a>]</span>.</p>
<p>Combining equations <a class="reference internal" href="#equation-zero-point1">(2.1)</a> and <a class="reference internal" href="#equation-zero-point2">(2.2)</a> we can infer the color <span class="math notranslate nohighlight">\(m_{BP}-m_{RP}\)</span> of a source as a function of <span class="math notranslate nohighlight">\(T_\mathrm{eff}\)</span>. This is illustrated below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">flux_ratio_BP_RP</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="c"># Ignoring constant in the integration as we just care about the ratio, relying on bins being equally spaced in lambda</span>
    <span class="n">F_sun_BP</span> <span class="o">=</span> <span class="n">sum</span><span class="p">(</span><span class="n">passbands</span><span class="o">.</span><span class="n">BP_pb</span> <span class="o">.*</span> <span class="n">B_λ</span><span class="o">.</span><span class="p">(</span><span class="n">passbands</span><span class="o">.</span><span class="n">lambda</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
    <span class="n">F_sun_RP</span> <span class="o">=</span> <span class="n">sum</span><span class="p">(</span><span class="n">passbands</span><span class="o">.</span><span class="n">RP_pb</span> <span class="o">.*</span> <span class="n">B_λ</span><span class="o">.</span><span class="p">(</span><span class="n">passbands</span><span class="o">.</span><span class="n">lambda</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">F_sun_BP</span><span class="o">/</span><span class="n">F_sun_RP</span>
<span class="k">end</span>

<span class="n">diff_zero_point_BP_RP</span> <span class="o">=</span> <span class="n">BP_sun</span> <span class="o">-</span> <span class="n">RP_sun</span> <span class="o">+</span> <span class="mf">2.5</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="n">flux_ratio_BP_RP</span><span class="p">(</span><span class="mi">5772</span><span class="p">))</span>

<span class="c"># sample </span>
<span class="n">log10_T_sample</span> <span class="o">=</span> <span class="kt">LinRange</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">6.0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">BP_sub_RP</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.5</span><span class="o">*</span><span class="n">log10</span><span class="o">.</span><span class="p">(</span><span class="n">flux_ratio_BP_RP</span><span class="o">.</span><span class="p">(</span><span class="mi">10</span> <span class="o">.^</span> <span class="n">log10_T_sample</span><span class="p">))</span> <span class="o">.+</span> <span class="n">diff_zero_point_BP_RP</span>

<span class="n">plot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;</span><span class="si">$log_</span><span class="s">{10} T_\mathrm{eff}$&quot;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;</span><span class="si">$m_</span><span class="s">\mathrm{BP}-m_\mathrm{RP}$&quot;</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">log10_T_sample</span><span class="p">,</span> <span class="n">BP_sub_RP</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/history_30_0.svg" src="../_images/history_30_0.svg" /></div>
</div>
<p>Now, on our quest to turn the Gaia Hertzsprung-Russell diagram into one of effective temperature versus luminosity, we run into a small problem. We have found a way to get a color from an effective temperature but what we need is the inverse! The inverse function can be computed numerically using a bisection algorithm. From the plot above we see that the relationship between temperature and color is monotonic. If we have an upper and a lower bound on the temperature that corresponds to a given color, we can iteratively improve on these bounds by taking their average and seeing if this new value corresponds to an upper or a lower bound. This can be iterated upon until the upper and lower bounds are close enough (down to a specific tolerance). The function below implements such a bisection solver.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c">#bisection algorithm to get Teff from the color BP-RP</span>
<span class="k">function</span> <span class="n">log10_T_from_BP_minus_RP</span><span class="p">(</span><span class="n">BP_minus_RP</span><span class="p">)</span>
    <span class="n">log10_T_min</span> <span class="o">=</span> <span class="mf">3.0</span> <span class="c"># lower bound</span>
    <span class="n">log10_T_max</span> <span class="o">=</span> <span class="mf">6.0</span> <span class="c"># upper bound</span>
    <span class="n">log10_T</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c"># initialize at an arbitrary value</span>
    <span class="k">while</span> <span class="n">abs</span><span class="p">(</span><span class="n">log10_T_min</span><span class="o">-</span><span class="n">log10_T_max</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.001</span> <span class="c"># Iterate until we reach this tolerance</span>
        <span class="c"># bisect bounds</span>
        <span class="n">log10_T</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">log10_T_max</span> <span class="o">+</span> <span class="n">log10_T_min</span><span class="p">)</span>
        <span class="c"># evaluate the color that corresponds to this temperature</span>
        <span class="n">BP_minus_RP_new</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.5</span><span class="o">*</span><span class="n">log10</span><span class="o">.</span><span class="p">(</span><span class="n">flux_ratio_BP_RP</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="n">log10_T</span><span class="p">))</span> <span class="o">.+</span> <span class="n">diff_zero_point_BP_RP</span>

        <span class="c"># Determine if the new value for log10_T is an upper or lower bound.</span>
        <span class="c"># This relies on BP-RP decreasing monotonically with temperature</span>
        <span class="k">if</span> <span class="n">BP_minus_RP_new</span> <span class="o">&gt;</span> <span class="n">BP_minus_RP</span> <span class="c"># T too low, update lower limit</span>
            <span class="n">log10_T_min</span> <span class="o">=</span> <span class="n">log10_T</span>
        <span class="k">else</span> <span class="c"># otherwise, update upper limit</span>
            <span class="n">log10_T_max</span> <span class="o">=</span> <span class="n">log10_T</span>
        <span class="k">end</span>
    <span class="k">end</span>
    <span class="k">return</span> <span class="n">log10_T</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># we use the function defined above to compute log10_Teff for all our Gaia sources </span>
<span class="n">log10_T</span> <span class="o">=</span> <span class="n">log10_T_from_BP_minus_RP</span><span class="o">.</span><span class="p">(</span><span class="n">color</span><span class="p">);</span> <span class="c">#remember that color is defined as BP-RP</span>
</pre></div>
</div>
</div>
</div>
<p>We can make use of this to make a <span class="math notranslate nohighlight">\(T_\mathrm{eff}\)</span> versus absolute G magnitude diagram.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;$\log_{10}T_\mathrm{eff}$&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s">&quot;Absolute G magnitude&quot;</span><span class="p">)</span>

<span class="n">scatter!</span><span class="p">(</span><span class="n">log10_T</span><span class="p">,</span> <span class="n">abs_G</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Gaia&quot;</span><span class="p">)</span>
<span class="n">scatter!</span><span class="p">([</span><span class="n">log10_T_from_BP_minus_RP</span><span class="p">(</span><span class="n">BP_sun</span><span class="o">-</span><span class="n">RP_sun</span><span class="p">)],[</span><span class="n">G_sun</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Sun&quot;</span><span class="p">)</span>
<span class="n">yflip!</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
<span class="n">xflip!</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/history_35_0.svg" src="../_images/history_35_0.svg" /></div>
</div>
<p>We’re almost there, just need to turn the y-axis into a luminosity! To do this, we first compute the ratio of flux in the G band versus the total flux for a source at a given temperature. Since we have that <span class="math notranslate nohighlight">\(F_\lambda = \pi B_\lambda\)</span> and <span class="math notranslate nohighlight">\(F=\sigma T^4\)</span> we find:</p>
<div class="math notranslate nohighlight">
\[R(T)\equiv\frac{F_G}{F}=\frac{\pi}{\sigma T^4}\int_0^\infty B_\lambda(\lambda, T) \varphi_G(\lambda)d\lambda.\]</div>
<p>Below we illustrate this ratio as a function of temperature.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">flux_ratio_G_total</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="c"># This numerical integration relies on bins being spaced by a nanometer in the passband data</span>
    <span class="n">F_G</span> <span class="o">=</span> <span class="nb">π</span><span class="o">*</span><span class="n">sum</span><span class="p">(</span><span class="n">passbands</span><span class="o">.</span><span class="n">G_pb</span> <span class="o">.*</span> <span class="n">B_λ</span><span class="o">.</span><span class="p">(</span><span class="n">passbands</span><span class="o">.</span><span class="n">lambda</span><span class="p">,</span><span class="n">T</span><span class="p">)</span> <span class="o">.*</span><span class="mf">1e-7</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">F_G</span><span class="o">/</span><span class="p">(</span><span class="n">σ</span><span class="o">*</span><span class="n">T</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">plot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;</span><span class="si">$log_</span><span class="s">{10} T_\mathrm{eff}$&quot;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;</span><span class="si">$F_</span><span class="s">\mathrm{G}/F$&quot;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="ss">:log</span><span class="p">,</span> <span class="n">ylims</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-4</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">legend</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">log10_T_sample</span><span class="p">,</span> <span class="n">flux_ratio_G_total</span><span class="o">.</span><span class="p">(</span><span class="mi">10</span> <span class="o">.^</span> <span class="n">log10_T_sample</span><span class="p">))</span> <span class="c"># log10_T_sample is an array defined previously, and goes from log10(T)=3 to 6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/history_37_0.svg" src="../_images/history_37_0.svg" /></div>
</div>
<p>As can be seen, if the temperature is pushed to very low or very high values we only capture a miniscule amount of the total light. This means that we have little information on the total luminosity and we can expect issues to appear when trying to convert from a G band magnitude to a total bolometric luminosity.</p>
<p>And now for the last step, how do we use this to convert from an absolute G magnitude to the bolometric luminosity? If we substract the absolute G magnitude of the Sun to that of another star we obtain</p>
<div class="math notranslate nohighlight" id="equation-abs-g-1">
<span class="eqno">(2.3)<a class="headerlink" href="#equation-abs-g-1" title="Permalink to this equation">#</a></span>\[M_{G} - M_{G,\odot} = -2.5 \log_{10}\left(\frac{L_{G}}{L_{G,\odot}}\right),\]</div>
<p>where <span class="math notranslate nohighlight">\(L_G\)</span> stands for the luminosity of the star weighted by the G filter passband,</p>
<div class="math notranslate nohighlight">
\[L_G=\int_0^{\infty} L_\lambda \varphi(\lambda)d\lambda\]</div>
<p>and <span class="math notranslate nohighlight">\(L_\lambda\)</span> is the luminosity per unit wavelength. Equation <a class="reference internal" href="#equation-abs-g-1">(2.3)</a> can be rewritten as</p>
<div class="math notranslate nohighlight">
\[M_{G} - M_{G,\odot} = -2.5\times\left[\log_{10}\left(\frac{L_{G}}{L}\right)+\log_{10}\left(\frac{L}{L_{\odot}}\right)+\log_{10}\left(\frac{L_\odot}{L_{G,\odot}}\right)\right].\]</div>
<p>The ratio between the luminosity of a source and its G band is just the quantity <span class="math notranslate nohighlight">\(R(T)\)</span> we have computed before. Using the corresponding temperature for the Sun and solving for <span class="math notranslate nohighlight">\(\log_{10}(L/L_\odot)\)</span> we get</p>
<div class="math notranslate nohighlight">
\[\log_{10}\left(\frac{L}{L_\odot}\right)=\frac{M_{G,\odot}-M_{G}}{2.5} - \log_{10}(R(T)) + \log_{10}(R(5772\;\mathrm{K})),\]</div>
<p>and remember that the temperature can be inferred from the color. With this we can complete our Hertzsprung-Russell diagram. As a check, we also include the predicted properties for stars on the zero-age main-sequence, which is the beginning of the core-hydrogen burning phase in the evolution of a star. These values of <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(T_\mathrm{eff}\)</span> come from the results of <span id="id3">[<a class="reference internal" href="../bibliography.html#id5" title="G. Schaller, D. Schaerer, G. Meynet, and A. Maeder. New Grids of Stellar Models from 0.8-SOLAR-MASS to 120-SOLAR-MASSES at Z=0.020 and Z=0.001. \aaps , 96:269, December 1992.">Schaller <em>et al.</em>, 1992</a>]</span> and <span id="id4">[<a class="reference internal" href="../bibliography.html#id6" title="C. Charbonnel, W. Däppen, D. Schaerer, P. A. Bernasconi, A. Maeder, G. Meynet, and N. Mowlavi. Grids of stellar models. VIII. From 0.4 to 1.0 \M$_sun$\ at Z=0.020 and Z=0.001, with the MHD equation of state. \aaps , 135:405-413, March 1999. arXiv:astro-ph/9810416, doi:10.1051/aas:1999454.">Charbonnel <em>et al.</em>, 1999</a>]</span> and cover masses between <span class="math notranslate nohighlight">\(0.4 M_\odot\)</span> and <span class="math notranslate nohighlight">\(2.5 M_\odot\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">log10_L_div_Lsun</span> <span class="o">=</span> <span class="p">(</span><span class="n">G_sun</span> <span class="o">.-</span> <span class="n">abs_G</span><span class="p">)</span><span class="o">./</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span> <span class="o">.-</span>
    <span class="n">log10</span><span class="o">.</span><span class="p">(</span><span class="n">flux_ratio_G_total</span><span class="o">.</span><span class="p">(</span><span class="mi">10</span> <span class="o">.^</span> <span class="n">log10_T</span><span class="p">))</span> <span class="o">.+</span> <span class="n">log10</span><span class="o">.</span><span class="p">(</span><span class="n">flux_ratio_G_total</span><span class="o">.</span><span class="p">(</span><span class="mi">5772</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;$\log_{10}T_\mathrm{eff}$&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;\log_{10}L/L_\odot&quot;</span><span class="p">)</span>

<span class="c"># Predicted Zero-age main-sequence location for stars of masses (in Msun):</span>
<span class="c">#     0.4, 0.8, 0.9, 1.0, 1.25, 1.5, 1.7, 2, 2.5</span>
<span class="c"># All models except that with M=0.4 Msun are from Schaller et al. (1992).</span>
<span class="c"># Model at 0.4 Msun is from Charbonnel et al. (1999).</span>
<span class="c"># These results were computed using the Geneva stellar evolution code</span>
<span class="n">log10_T_geneva</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.568</span><span class="p">,</span> <span class="mf">3.687</span><span class="p">,</span> <span class="mf">3.724</span><span class="p">,</span> <span class="mf">3.751</span><span class="p">,</span> <span class="mf">3.808</span><span class="p">,</span> <span class="mf">3.852</span><span class="p">,</span> <span class="mf">3.901</span><span class="p">,</span> <span class="mf">3.958</span><span class="p">,</span> <span class="mf">4.031</span><span class="p">]</span>
<span class="n">log10_L_geneva</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.63</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.612</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.394</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.163</span><span class="p">,</span> <span class="mf">0.325</span><span class="p">,</span> <span class="mf">0.676</span><span class="p">,</span> <span class="mf">0.916</span><span class="p">,</span> <span class="mf">1.209</span><span class="p">,</span> <span class="mf">1.600</span><span class="p">]</span>

<span class="n">scatter!</span><span class="p">(</span><span class="n">log10_T</span><span class="p">,</span> <span class="n">log10_L_div_Lsun</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;Gaia&quot;</span><span class="p">)</span>
<span class="n">scatter!</span><span class="p">([</span><span class="n">log10_T_from_BP_minus_RP</span><span class="p">(</span><span class="n">BP_sun</span><span class="o">-</span><span class="n">RP_sun</span><span class="p">)],[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;Sun&quot;</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">log10_T_geneva</span><span class="p">,</span> <span class="n">log10_L_geneva</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span> <span class="ss">:dot</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;orange&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;ZAMS&quot;</span><span class="p">)</span>
<span class="n">xflip!</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/history_40_0.svg" src="../_images/history_40_0.svg" /></div>
</div>
<p>Here we see that the predicted zero-age main-sequence matches well the observed stars except at low luminosities and effective temperatures. This is not entirely surprising, as for those low temperatures we have already seen that the Gaia filters only cover a small fraction of the total luminosity of the star.</p>
<p>Feel free to further play with this data. For instance, using <span class="math notranslate nohighlight">\(L=4\pi R^2\sigma T_\mathrm{eff}^4\)</span> you can determine the radii of these stars, and compare how much the radii in the main-sequence differ from those of the white dwarfs.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.8"
        },
        kernelOptions: {
            kernelName: "julia-1.8",
            path: "./history"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.8'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../instructions/instructions.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">1. </span>Instructions</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../equations/equations.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">3. </span>The equations of stellar structure and evolution</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Pablo Marchant & Annachiara Picco<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>